{% extends "layout.html" %}


{% block title %}Dashboard{% endblock %}


{% block stylesheets %}
<style type="text/css">
    
    html, body {
        height: 100%;
        min-width: 800px;
    }

    .navbar {
        margin-bottom: 0;
    }

    .left-fixed {
        float: left;
        width:200px;
        border-right: 3px solid lightgrey;
        height: 100%;
        margin-top: -51px;
    }

    .left-fixed .nav {
        margin-top: 51px;
    }

    .left-footer {
        position: absolute;
        bottom: 10px;
        width: 197px;
        text-align: center;
        font-size: 0.9em;
        color: #696969;
    }

    .right-fluid {
        margin-left: 200px;
        padding: 10px;
    }

</style>
{% endblock %}


{% block container %}
<div class="navbar navbar-default navbar-static-top" role="navigation">
    <a class="navbar-brand" href="/">Open Data Press</a>
    <ul class="nav navbar-nav navbar-right">
        <li><a class="navbar-link" href="/{{current_user.profile_slug|e}}" target="_blank">My Profile</a></li>
        <li><a class="navbar-link" href="#/settings">Settings</a></li>
        <li><a class="navbar-link" href="/auth/logout">Logout</a></li>
    </ul>
</div>
<div class="left-fixed">
    <ul class="nav nav-pills nav-stacked" role="navigation">
        <li><a href="/dashboard">Dashboard</a></li>
        <li><a href="#/data_source">All Data Sources</a></li>
        <li><a href="#/data_source/10">Data Source 10</a></li>
        <li><a href="#/data_view">All Data Views</a></li>
        <li><a href="#/data_view/10">Data View 10</a></li>
    </ul>
    <div class="left-footer">
        <hr>
        Open Data Press v0.1 <br>
        <a href="#">Help</a> -
        <a href="#">About</a> -
        <a href="#">Contact</a>
    </div>
</div>
<div class="right-fluid" id="dash-content"></div>
{% endblock %}


{% block templates %}
<script id="tpl-loading" type="text/html">
    <div style="text-align:center">
        Loading. Please wait...
    </div>
</script>

<script id="tpl-error" type="text/html">
    <div style="text-align:center">
        I&apos;m Sorry, Something went wrong... <strong>:(</strong>
    </div>
</script>
{% endblock %}


{% block javascripts %}
<script src="/js/jquery.js"></script>
<script src="/js/bootstrap.js"></script>
<script src="/js/router.js"></script>

<script type="text/javascript">
    
    (function(){
        var 

        /* Dynamic page elements */
        dash_content = $('#dash-content'),


        /* Static Templates */
        tpl_loading = $('#tpl-loading').html(),
        tpl_error   = $('#tpl-error').html(),


        /* Handlebars Templates */
        // TODO

        /* URL Route Handlers */
        router = new Router()

        .before(function(req, next){
            dash_content.html(tpl_loading);
            setTimeout(function(){next();}, 1000); //Fake request delay
            // next();
        })

        .addRoute('#/settings', function(req, next){
            console.log(req);
            dash_content.html('Profile settings');
        })

        .addRoute('#/data_source', function(req, next){
            console.log(req);
            dash_content.html('All data sources');
        })

        .addRoute('#/data_source/:data_source_id', function(req, next){
            console.log(req);
            dash_content.html('Data Source ' + req.params.data_source_id);
        })

        .addRoute('#/data_view', function(req, next){
            console.log(req);
            dash_content.html('All data views');
        })

        .addRoute('#/data_view/:data_view_id', function(req, next){
            console.log(req);
            dash_content.html('Data View ' + req.params.data_view_id);
        })

        .errors(404, function(){
            dash_content.html('Dashboard');
        })

        .run()


        /* Event Handlers */
        // TODO

    })()

</script>
{% endblock %}